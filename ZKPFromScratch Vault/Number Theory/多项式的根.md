**例**：求解多项式 $x^2-1 \equiv 0 \mod p$ 的根，其中 $p$ 是质数。

显然，$x=\pm 1$ 可以，但是否还有其他解呢？假设 $(x+1)(x-1) \equiv 0 \mod p$ 。由于 $p$ 是质数，所以它要么整除 $(x+1)$ ，要么整除 $(x-1)$ 。这两种情况对应于前面得到的根，所以没有其他解了。

更一般的，有如下定理：

**定理**：令 $f(x)$ 是 $\mathbb{Z}_p$ 上的 $n$ 阶多项式，则 $f(x)$ 至多有 $n$ 个根。

**证明**：

可用数学归纳法。对于一阶多项式 $ax+b$，有唯一根 $x=-ba^{-1}$ 。

假设 $f(x)$ 是 $n$ 阶多项式，且至少有一个根 $a$，则$f(x)$ 可以写成 $f(x)=(x-a)g(x)$ ，其中 $g(x)$ 是 $n-1$ 阶多项式。于是 $f(x) \equiv 0 \mod p$ 意味着 $(x-a)g(x)$ 是 $p$ 的倍数。

既然 $p$ 是质数，所以 $p$ 可以整除 $(x-a)$ 或 $g(x)$ 。如果是前者，方程有一个根 $a$ ；如果是后者，就意味着 $g(x) \equiv 0 \mod p$ ，至多有 $n-1$ 个根。

# 合数模

令 $n$ 等于一些不同质数的乘积：$n=p_1...p_k$ 。[[中国剩余定理]] 意味着我们可以先在每个 $\mathbb{Z}_{p_i}$ 上求解多项式 $f(x)$ ，然后把根组合在一起来得到模 $n$ 下的根。这是因为 $f(x)$ 在 $\mathbb{Z}_n$ 下的根 $a$ 可以对应于：
$$(a_1,...,a_k) \in \mathbb{Z}_{p_1} \times ... \times \mathbb{Z}_{p_k}$$ 其中每个 $a_i$ 分别是 $f(x)$ 在 $\mathbb{Z}_{p_i}$ 下个根。

**例**：求解 $x^2-1 \mod 77$ 。

$x^2-1$ 有根 $\pm 1 \mod 7$ 和 $\pm 1 \mod 11$ （因为 7, 11 都是质数），因此模 77 的根分别是：
- 当 $x=1 \mod 7, x=1 \mod 11$ 时，$x=1 \mod 77$ 
- 当 $x=1 \mod 7, x=-1 \mod 11$ 时，$x=43 \mod 77$ 
- 当 $x=-1 \mod 7, x=1 \mod 11$ 时，$x=34 \mod 77$ 
- 当 $x=-1 \mod 7, x=-1 \mod 11$ 时，$x=-1 \mod 77$ 

>【译注】以第二个根为例，对应坐标为 $(1,-1) \in \mathbb{Z}_7 \times \mathbb{Z}_{11}$ 。合成方式为：$$x=a_1 b_1 b_1' + a_2 b_2 b_2' \mod 77$$其中 $a_1=1,\; a_2=-1,\;  b_1=11,\; b_2=7$ 。$$
\begin{align*}
b_1'&=11^{-1} &\equiv 2& \mod 7 \\
b_2'&=7^{-1} &\equiv 8& \mod 11
\end{align*}
$$所以 $x=1 \times 11 \times 2+(-1)\times 7 \times 8=-34 \equiv 43 \mod 77$ 。

泛化这个例子，当 $N$ 是任意两个不同的奇质数之积时，我们总是可以得到 4 个单位元的平方根。（当其中一个质数是 2 时，会得到重根，因为 $1 \equiv -1 \mod 2$ 。）一个有趣的事实是，只要得知其中任一非平凡的平方根，我们就能对 $N$ 因式分解。（怎么做到？）

>【译注】注意到 $(x-1)(x+1)=kN, \; k \in N$ 。由于 $x$ 的数值是非平凡的，也就是 $x \not \equiv \pm 1 \mod N$ ，所以 $(x - 1)$ 和 $(x+1)$ 都不是 $N$ 的整数倍，即都不能被 $N$ 整除。又因为 $N$ 能整除他们的积，$N=pq$ ，所以 $(x - 1)$ 和 $(x+1)$ 分别包含了 $N$ 中的一个质数子。于是计算 $\gcd(x - 1, N)$ 或 $\gcd(x+1, N)$ 就可以得到其中一个质因子，从而分解 $N$ 。

为了描述多项式 $f(x)$ 在任意 $\mathbb{Z}_n$ 下的根，我们需要计算 $f(x)$ 在 $\mathbb{Z}_{p^k}$ 下的根。这个问题稍后解决。

# Wilson 定理

既然在模质数 $p$ 下，1 的平方根只有 $\pm 1$ ，则对于任意 $a \in \mathbb{Z}_p$ ，有 $a \ne a^{-1}$ ，除非 $a= \pm 1$ 。因此 $\{2, 3, ..., p-2\}$ 中的每个元素分别对应不同的乘法逆元，所以 $(p-1)! \equiv -1 \mod p$ 。另一方面，如果 $p$ 是合数，则 $(p-1)!$ 可以被 $p$ 的所有真因子整除。

> 【译注】当 p 是奇质数时，$\{2, 3, ..., p-2\}$ 中有偶数个元素，他们的逆元各不相同，也就是重新排列，所以他们的乘积会互相抵消。于是 $$(p-1)! \equiv 1 \times (p-1) \equiv -1 \mod p$$当 $p$ 是合数时，它的真因子肯定是 $[1,p-1]$ 之间的整数，所以 $(p-1)!$ 跟 $p$ 并不互质。由 [[模除法]] 可知，$(p-1)!$ 不存在乘法逆元，于是 $(p-1)! \not \equiv -1 \mod p$ 。

**定理**：对于整数 $p>1$ ，当且仅当 $p$ 是质数时，有 $(p-1)! \equiv 1 \mod p$ 。

第一眼看去，这似乎是判断质数的好办法，但不幸的是，目前还没有计算 $(p-1)!$ 的有效算法。

**定理**：对于奇数 $p>1$ ，令 $r=(p-1)/2$ ，则当且仅当 $p$ 是质数时，有 $$(-1)^r(r!)^2 \equiv -1 \mod p$$**证明**：
$$
\begin{align*}
(p-1)! &= 1(p-1)2(p-2)...((p-1)/2)((p+1)/2) \\
 &= 1(-1)2(-2)...r(-r) \\
 &= (-1)^r(r!)^2
\end{align*}
$$
然后应用 Wilson 定理可证。