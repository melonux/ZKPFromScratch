给定三个整数 $a,b,c$，你能把 $c$ 表达为下述形式吗？其中 $x,y \in \mathbb{Z}$ 。
$$c=ax+by$$
如果可以，是否有不止一个解？你能给出全部的解吗？在回答这个问题之前，让我们先回答一个看起来无关的问题：

如何计算两个整数 $a,b$ 的最大公约数（gcd）？

我们用符号 $\gcd(a,b)$ 表示 $a,b$ 的最大公约数，有时甚至简记为 $(a,b)$ 。如果 $(a,b)=1$，则称 $a,b$ 是*互质*的 (*coprime*)。

一种显然的答案是列出 $a,b$ 的全部因子，然后找出它们共有的最大因子。然而这要求对 $a,b$ 进行因子分解，目前还不存在有效的算法。

通过简单的观察就可以得出一个更棒的方法：Euclid 算法。首先，如果 $d$ 可以同时整除 $a,b$，那么它就可以整除 $a-b$ （其中 $a \ge b$）。这意味着我们简化了原问题：现在只需计算 $\gcd(a, a-b)$ 。我们一直重复这个过程，直到问题简单到一眼就能看出答案。

于是我们可以用大多数人在小学时就掌握的除法和余数来求出 $\gcd(a,b)$ 了。下面给出示例，把一般情况的证明留给读者。

比如想计算 $\gcd(27,33)$ 。首先，我们用较小的数去拆分较大的数：
$$33=1 \times 27 + 6$$
因此 $\gcd(27,33)=\gcd(27,6)$ 。重复这个技巧：
$$27 = 4 \times 6 + 3$$ 得到 $\gcd(27,6)=\gcd(6,3)$ 。最终，
$$6=2 \times 3 + 0$$
既然 $6$ 是 $3$ 的倍数，那么 $\gcd(6,3)=3$，所以我们得到 $\gcd(27, 33)=3$ 。

这个算法无需因子分解，而且速度很快。我们可以对所需计算次数做粗略的估计。如果 $a$ 除以 $b$ 得到 $a=bq+r$，其中 $r>b/2$ ，则在下一步中得到于余数 $r' \le b/2$ 。因此每经过两步，数值至少缩减 1 bit。

> 【译注】一步运算后，问题从 $\gcd(a,b)$ 转化为 $\gcd(b,r)$ 。分两种情况
> 1. 如果 $r \le b/2$ ，则 $b=rq'+r'$ ，必然有 $r' \le b/2$ ；
> 2. 如果 $r>b/2$，则 $b=r \times 1+r'$ ，仍然有 $r' \le b/2$ 。 

# 扩展 Euclid 算法 (Extended Euclidean Algorithm)

实际上，上面的等式揭示了比两个数的 $\gcd$ 更多的信息。我们可以用他们来找到整数 $m,n$ 满足
$$3 = 33m+27n$$
首先整理一下等式，把余数放到左侧：
$$
\begin{align*}
6 &= 33 - 1 \times 27 \\
3 &= 27 - 4 \times 6
\end{align*}
$$
然后从最后一个等式开始，把上一个等式代入进来：
$$3 = 27 - 4 \times (3 - 1 \times 27) = (-4) \times 33 + 5 \times 27$$
从而得到：$m=-4, \; n=5$ 。

如果有更多等式，就需要不断代入每一个等式，最终得到 $m,n$ 。

因此一般说来，给定整数 $a,b$ ，令 $d=\gcd(a,b)$ 。那么我们就能使用扩展 Euclid 算法找到一对整数 $m,n$ 满足
$$d=ma+nb$$
# 通解

现在我们可以回答开篇的问题了，给定整数 $a,b,c$ ，找到所有的整数对 $x,y$ 满足 
$$c=xa+yb \tag{1}$$
令 $d=\gcd(a,b),\; a=a'd, \; b=b'd$ 。可见对任意整数 $x,y$ ，$xa+yb$ 都是 $d$ 的倍数，所以仅当 $d$ 能整除 $c$ 时，方程 (1) 才有解。

不妨令 $c=kd$ 。使用扩展 Euclid 算法，我们可以找到满足 $d=ma+nb$ 的 $m,n$，于是得到一个解 $x=km, \; y=kn$ 。

假设 $x',y'$ 是另一组解，则
$$c=xa+yb=x'a+y'b$$
整理得，
$$(x'-x)a=(y-y')b$$
两侧同除以 $d$ 得：
$$(x'-x)a'=(y-y')b' \tag{2}$$
因为 $d$ 是最大公约数， $a',b'$ 是互质的，所以 $(x-x')$ 是 $b'$ 的倍数，即：
$$x'-x=tb'$$
其中 $t \in \mathbb{Z}$。代入 (2) 得
$$y-y'=ta'$$
因此 
$$
\begin{align*}
x'&=x+tb'=x+tb/d \\
y'&=y-ta'=y-ta/d
\end{align*}
$$
注意到上式对任意的 $t \in \mathbb{Z}$ 都成立，因此原方程 (1) 的可以有无数组解，通解为：
$$
\begin{align*}
x&=km+tb/d \\
y&=kn-ta/d
\end{align*} \tag{3}
$$
> 【译注】可以将通解代回原方程 (1) 验证一下 $$
\begin{align*}
kma+\cancel{tab/d}+knb-\cancel{tab/d}&=kd \\
&\Downarrow \\
ma+nb&=d
\end{align*}
$$

将来我们会经常需要求解方程 $1=xp+yq$ ，其中 $p,q$ 互质。在这种情况下，(3) 会变为：
$$
\begin{align*}
x&=m+tq \\
y&=n-tp
\end{align*}
$$
>【译注】即 $d=1,k=1$ 这种特殊情况下的通解。

>【译注】整体思路就是用 Euclid 算法得到一个特解 $x=km,\; y=kn$ ，然后利用 (3) 扩展成通解。
