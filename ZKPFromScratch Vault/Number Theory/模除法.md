直觉上，$x$ [[模运算|除以]] $y$ 就是去找一个数 $z$ 满足 $yz=x$ ，但在模 $n$ 的情况下，有时会有多个可行的 $z$ 。这给我们定义模除法带来了困难。

我们的解法是仅在答案唯一时才让模除法有定义。先不给证明，我们断言 $x$ 可以被 $y$ 除当且仅当 $y$ 的逆元 $y^{-1}$ 存在。

现在我们来证明为什么如此。我们尝试找打所有的 $z$ 满足 $yz \equiv x \mod n$ ，由定义可知，存在某个 $k \in \mathbb{Z}$，使得：
$$x=zy+kn \tag{1}$$
二者恰恰是我们讨论 [[Euclid 算法]] 时所处理的问题！令 $d=\gcd(y,n)$ 。

假设 $d>1$ 。如果 $x$ 不是 $d$ 的整数倍的话，方程就无解；如果 $x$ 是 $d$ 的整数倍，方程的解为：
$$
\begin{align*}
z &= k'r + tn/d \\
k &= k's-t y/d
\end{align*}
$$
其中 $k'=x/d$ 整数 $r,s$ 是由 Euclid 算法求出的值，$t$ 是任意整数。但这意味着模 $n$ 下的解 $z$ 并不唯一，因为 $n/d < n$ 。

另一方面，如果 $d=1$ ，即如果 $y,n$ 互质，则 $x$ 必然是 $d$ 的倍数，所以方程 (1) 有解。回想一下，我们是通过 Euclid 算法求出 $r,s$ 进而找到解的，其中 $r,s$ 满足：
$$1=ry+sn$$
于是方程 (1) 的通解 $z,k$ 可写为
$$
\begin{align*}
z&=xr+tn \\ 
k&=xs-ty
\end{align*}
$$
其中 $t$ 是任意整数。于是，$z$ 在模 $n$ 中唯一，且除法在这种情况下有意义。
>【译注】$d=1$，所以 $k'=x$ 。由于 $z=xr+tn \equiv xr \mod n$ ，所以 $z$ 在模 $n$ 下唯一。

另外，$r$ 满足 $ry \equiv 1 \mod n$ ，所以事实上 $y^{-1}=r$ 。因此我们之前的断言是正确的： $x$ 可以被 $y$ 除当且仅当 $y$ 的逆元 $y^{-1}$ 存在。

我们还可以说，当且仅当 $\gcd(y,n)=1$ 时， $y$ 有逆元 。（事实上，我们只是从一个方向证明了这些陈述，但另一个方向也很容易。）

注：有些时候，即使 $x,y$ 不能进行模 $n$ 除法，我们也需要找到所有满足 $yz=x$ 的 $z$ 。

# 计算逆元

回到之前的问题：给定 $y \in \mathbb{Z}_n$ ，$y^{-1}$ 是否存在？如果存在，值是什么？

我们之前的回答是，由于 $\mathbb{Z}_n$ 是有限的，我们可以尝试所有可能。但如果 $n$ 很大，比如 256 bit 的整数，即使是当今最快的计算机也无法办到了。

更好的方法是使用我们刚刚证明的结论：$y^{-1}$ 存在当且仅当 $\gcd(y,n)=1$，以及 $y^{-1}$ 可以使用扩展 Euclid 算法快速的计算出来。

**例**：$7^{-1} \mod 19$ 存在吗？如果是，值是多少？由 Euclid 算法：
$$
\begin{align*}
19 &= 2 \times 7 + 5 \\
7 &= 1 \times 5 + 2 \\
5 &= 2 \times 2 + 1
\end{align*}
$$
因为 $\gcd(7,19)=1$ ，所以逆元存在。为了找到这个逆元，我们整理这些等式使得余数在左侧。然后从第三个等式开始，代入第二个等式得：
$$
\begin{align*}
1 &= 5 - 2 \times 2 \\
&= 5 - 2 \times (7 - 1 \times 5) \\
&= (-2) \times 7 + 3 \times 5
\end{align*}
$$
再带入第一个等式得：
$$
\begin{align*}
1 &= (-2) \times 7 + 3 \times (19 - 2 \times 7) \\
 &= (-8) \times 7 + 3 \times 19
\end{align*}
$$
由此我们可以看出 $7^{-1}=-8 \equiv 11 \mod 19$ 。
> 【译注】对等式两侧取模 $19$ 可得：$1 = (-8) \times 7 + 3 \times 19 \equiv (-8) \times 7 \mod 19$ 。
